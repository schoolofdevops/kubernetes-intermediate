# Phase 1: Platform Foundation - Research

**Researched:** 2026-02-08
**Domain:** Docusaurus Static Site Platform Setup
**Confidence:** HIGH

## Summary

Phase 1 establishes the technical foundation for the Kubernetes Intermediate course site using Docusaurus 3.9.2. This phase focuses on creating a fully responsive, accessible documentation platform with automated deployment to GitHub Pages. The core challenge is configuring Docusaurus with proper navigation structure, responsive design, dark mode support, syntax-highlighted code blocks, and search functionality—all while maintaining a developer-friendly workflow.

Research confirms that Docusaurus 3.9.2 is production-ready with React 19 support, built-in responsive design, automatic dark mode with localStorage persistence, and native GitHub Actions integration. The platform requires minimal custom code for Phase 1 requirements, relying heavily on Docusaurus built-in features and the classic preset.

**Primary recommendation:** Use `create-docusaurus` with the TypeScript classic template, enable auto-generated sidebars from the filesystem, configure GitHub Actions deployment source in repository settings, and start with local search plugin while applying for Algolia DocSearch for production.

## Standard Stack

### Core Dependencies

| Library | Version | Purpose | Why Standard |
|---------|---------|---------|--------------|
| Docusaurus | 3.9.2 | Static site generator | Meta-maintained, designed for documentation. Built-in responsive design, dark mode, navigation, search integration. React-based for extensibility. |
| React | 19.x | UI framework | Required by Docusaurus 3.7+. Enables custom components in MDX for future interactivity (quizzes, labs). |
| TypeScript | 5.1+ | Type safety | First-class Docusaurus support. Recommended for `docusaurus.config.ts` and custom components. |
| Node.js | 20.x LTS | Runtime | Modern LTS version. Compatible with GitHub Actions. Docusaurus 3.x requires Node 18+ minimum. |
| npm | 10.x | Package manager | Default with Node 20. Use `npm ci` in CI/CD for reproducible builds. |

### Theme & Styling

| Library | Version | Purpose | Why Standard |
|---------|---------|---------|--------------|
| @docusaurus/preset-classic | 3.9.2 | Standard theme preset | Provides docs plugin, blog plugin, theme components. Includes Infima CSS framework for responsive design. |
| Infima | (via preset) | CSS framework | Default Docusaurus styling. Responsive out-of-box, CSS variables for customization, WCAG-AA contrast support. |
| Prism React Renderer | (via preset) | Syntax highlighting | Built-in syntax highlighting with copy button. Supports 60+ languages. Theme customizable via config. |

### Search Solutions

| Solution | Version | Purpose | When to Use |
|----------|---------|---------|-------------|
| @cmfcmf/docusaurus-search-local | Latest | Client-side search | Phase 1 implementation. No external dependencies, works offline, index downloads to browser. Adequate for 10 sections. |
| Algolia DocSearch | v5 (via plugin) | Production search | Apply during Phase 1, activate when approved. FREE for open-source. Auto-crawls weekly. Superior UX. |

### Deployment & CI/CD

| Tool | Version | Purpose | Why Standard |
|------|---------|---------|--------------|
| GitHub Pages | - | Static hosting | FREE for public repos. Native GitHub integration. Reliable CDN. Perfect for educational content. |
| GitHub Actions | - | CI/CD automation | Native to GitHub. Modern workflow: `actions/checkout@v4`, `actions/setup-node@v4`, `actions/upload-pages-artifact@v3`, `actions/deploy-pages@v4`. |

**Installation:**
```bash
# Initialize Docusaurus (TypeScript template)
npx create-docusaurus@latest kubernetes-intermediate classic --typescript

# Navigate to project
cd kubernetes-intermediate

# Install local search plugin
npm install @cmfcmf/docusaurus-search-local

# Development tools (optional but recommended)
npm install -D @docusaurus/eslint-plugin eslint prettier
npm install -D @docusaurus/tsconfig
```

## Architecture Patterns

### Pattern 1: Auto-Generated Sidebar Navigation

**What:** Docusaurus automatically generates sidebar navigation from the filesystem structure. Frontmatter controls ordering and labels.

**When to use:** Always for course content. Eliminates manual `sidebars.js` maintenance and ensures sidebar matches filesystem reality.

**Trade-offs:**
- **Pro:** Zero maintenance. Add a file, it appears in sidebar. Rename a folder, sidebar updates. Clear relationship between files and navigation.
- **Con:** Limited control over complex nested structures. Custom sidebars require manual configuration.

**Example:**
```typescript
// sidebars.ts - minimal configuration
import type {SidebarsConfig} from '@docusaurus/plugin-content-docs';

const sidebars: SidebarsConfig = {
  courseSidebar: [
    {
      type: 'autogenerated',
      dirName: '.', // Docusaurus generates from docs/ root
    },
  ],
};

export default sidebars;
```

```json
// docs/section-0/_category_.json
{
  "label": "Section 0: Essentials Refresh",
  "position": 1,
  "collapsible": true,
  "collapsed": false
}
```

```markdown
<!-- docs/section-0/01-overview.mdx -->
---
sidebar_position: 1
title: Overview
---
```

### Pattern 2: Responsive Design with Built-In Breakpoints

**What:** Docusaurus uses 996px as the cutoff between mobile and desktop. Responsive behavior is automatic for navbar, sidebar, TOC. Custom styles use media queries.

**When to use:** Default responsive behavior works for 95% of cases. Only customize for course-specific needs (e.g., custom components).

**Trade-offs:**
- **Pro:** Works out-of-box. Header and sidebar implement different JavaScript logic for mobile. No configuration needed.
- **Con:** If changing breakpoint value in custom CSS, must also update `useWindowSize` hook invocations by swizzling components.

**Example:**
```css
/* src/css/custom.css */
:root {
  /* Desktop spacing */
  --ifm-spacing-horizontal: 1.5rem;
}

@media (max-width: 996px) {
  /* Mobile spacing */
  :root {
    --ifm-spacing-horizontal: 1rem;
  }

  /* Hide complex diagrams on mobile, show simplified version */
  .desktop-only-diagram {
    display: none;
  }
}
```

### Pattern 3: Dark Mode with localStorage Persistence

**What:** Docusaurus classic theme provides dark mode toggle in navbar with automatic localStorage persistence. User preference survives page reloads.

**When to use:** Always. Built-in feature requires no custom code. Developer-focused audience expects dark mode.

**Trade-offs:**
- **Pro:** Free functionality. Persists automatically. Respects system theme preference by default. Can be disabled or forced via config.
- **Con:** Must ensure custom components respect theme. Use CSS variables, not hardcoded colors.

**Example:**
```typescript
// docusaurus.config.ts
const config: Config = {
  themeConfig: {
    colorMode: {
      defaultMode: 'light',
      disableSwitch: false,  // Keep toggle enabled
      respectPrefersColorScheme: true,  // Respect system theme
    },
  },
};
```

```css
/* src/css/custom.css - Use CSS variables for theme compatibility */
.custom-component {
  background-color: var(--ifm-background-color);
  color: var(--ifm-font-color-base);
  border: 1px solid var(--ifm-color-emphasis-300);
}
```

### Pattern 4: GitHub Actions Deployment with OIDC

**What:** GitHub Actions workflow builds Docusaurus site and deploys to GitHub Pages using OIDC authentication. No manual token management.

**When to use:** Always. Modern approach replaces legacy "deploy from branch" method. Enables PR preview builds.

**Trade-offs:**
- **Pro:** Secure (no PAT needed). Fast deployment. Allows testing builds on PRs without deploying. Standard workflow.
- **Con:** Requires repository settings change to enable "GitHub Actions" deployment source.

**Example:**
```yaml
# .github/workflows/deploy.yml
name: Deploy to GitHub Pages

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

permissions:
  contents: read
  pages: write
  id-token: write

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: 20
          cache: npm

      - name: Install dependencies
        run: npm ci

      - name: Build site
        run: npm run build

      - name: Upload artifact
        uses: actions/upload-pages-artifact@v3
        with:
          path: build/

      - name: Deploy to GitHub Pages
        if: github.ref == 'refs/heads/main'
        uses: actions/deploy-pages@v4
```

### Pattern 5: Code Blocks with Copy Button and Syntax Highlighting

**What:** Docusaurus uses Prism React Renderer for automatic syntax highlighting. Copy button built-in for all code blocks.

**When to use:** No configuration needed—works automatically. Specify language in code fence for highlighting.

**Trade-offs:**
- **Pro:** Supports 60+ languages. Copy button automatic. Theme customizable. Magic comments for line highlighting.
- **Con:** Less common languages (Java, C#, PHP) require explicit `additionalLanguages` config.

**Example:**
```typescript
// docusaurus.config.ts
const config: Config = {
  themeConfig: {
    prism: {
      theme: prismThemes.github,  // Light theme
      darkTheme: prismThemes.dracula,  // Dark theme
      additionalLanguages: ['bash', 'yaml', 'json'],  // Add if not in default set
    },
  },
};
```

````markdown
<!-- docs/example.mdx -->
```yaml title="pod.yaml"
apiVersion: v1
kind: Pod
metadata:
  name: nginx
spec:
  containers:
  - name: nginx
    image: nginx:1.14.2
```
````

## Recommended Project Structure

```
kubernetes-intermediate/
├── .github/
│   └── workflows/
│       └── deploy.yml              # GitHub Pages deployment
│
├── docs/                           # Course content (auto-generated sidebar)
│   ├── section-0/
│   │   ├── _category_.json         # Section metadata
│   │   ├── 01-overview.mdx
│   │   └── 02-setup.mdx
│   ├── section-1/
│   └── ...section-9/
│
├── src/
│   ├── pages/                      # Custom pages
│   │   └── index.tsx               # Homepage
│   └── css/
│       └── custom.css              # Custom styles
│
├── static/                         # Static assets
│   ├── img/
│   └── downloads/
│
├── docusaurus.config.ts            # Main configuration
├── sidebars.ts                     # Sidebar configuration (auto-generated)
├── package.json
├── tsconfig.json
└── README.md
```

**Structure rationale:**
- `docs/section-N/`: Matches 10-section course outline. Auto-generates sidebar.
- `_category_.json`: Controls section label and position without manual sidebar config.
- `src/pages/index.tsx`: Custom homepage (can be simple landing page for Phase 1).
- `src/css/custom.css`: Override CSS variables for branding, typography.
- `.github/workflows/deploy.yml`: Automated deployment on push to main.

## Don't Hand-Roll

| Problem | Don't Build | Use Instead | Why |
|---------|-------------|-------------|-----|
| Responsive navigation | Custom hamburger menu, mobile breakpoints | Docusaurus built-in | Handles edge cases (touch events, keyboard nav, backdrop), mobile sidebar logic already implemented |
| Dark mode toggle | Custom theme switcher with localStorage | Docusaurus colorMode config | Respects system preference, handles flash-of-wrong-theme, persists automatically |
| Syntax highlighting | Custom Prism.js integration | Docusaurus built-in Prism | Copy button, line highlighting, theme switching, language detection built-in |
| Search indexing | Custom search with Lunr.js or Fuse.js | @cmfcmf/docusaurus-search-local or Algolia | Plugin handles indexing during build, integrates with Docusaurus UI, offloads crawling to Algolia |
| Breadcrumbs | Custom breadcrumb component | Docusaurus built-in | Auto-generated from sidebar path, updates automatically when structure changes |
| Next/Previous buttons | Custom pagination | Docusaurus built-in | Follows sidebar order, updates when content reordered, respects auto-generated structure |

**Key insight:** Docusaurus classic preset provides 90% of Phase 1 requirements out-of-box. Custom code should only handle course-specific features (quizzes, lab components) in later phases. Platform foundation requires configuration, not custom development.

## Common Pitfalls

### Pitfall 1: Incorrect baseUrl/url Configuration

**What goes wrong:** Site deploys but assets fail to load. Links broken. CSS/JS 404 errors. Site looks unstyled or completely broken.

**Why it happens:** GitHub Pages serves from `https://<org>.github.io/<repo>/` but `baseUrl` set to `/`. Or vice versa—deploying to custom domain but `baseUrl` includes repo name.

**How to avoid:**
```typescript
// docusaurus.config.ts
const config: Config = {
  url: 'https://schoolofdevops.github.io',  // GitHub Pages URL
  baseUrl: '/kubernetes-intermediate/',      // Repo name with slashes
  organizationName: 'schoolofdevops',
  projectName: 'kubernetes-intermediate',
  trailingSlash: false,
};
```

**Verification:**
```bash
# Build locally and check paths
npm run build
grep -r "href=" build/index.html | head -5
# Should show: href="/kubernetes-intermediate/assets/..."

# Serve locally with correct base path
npm run serve
# Open http://localhost:3000/kubernetes-intermediate/
```

**Warning signs:**
- Browser console shows 404 for CSS/JS files
- Page loads but styling missing
- Links work locally but not on GitHub Pages
- Images broken in production

### Pitfall 2: GitHub Actions Permission Errors

**What goes wrong:** Workflow runs but fails at deploy step with "Write access to repository not granted" or "Resource not accessible by integration" errors.

**Why it happens:** GitHub Pages deployment requires specific permissions (`pages: write`, `id-token: write`, `contents: read`). Default `GITHUB_TOKEN` has limited permissions. Repository settings may not have "GitHub Actions" deployment source enabled.

**How to avoid:**
1. **Configure repository settings:**
   - Go to repository Settings > Pages
   - Under "Build and deployment" > Source, select "GitHub Actions" (NOT "Deploy from a branch")

2. **Set workflow permissions:**
```yaml
# .github/workflows/deploy.yml
permissions:
  contents: read    # Required to checkout code
  pages: write      # Required to deploy to Pages
  id-token: write   # Required for OIDC authentication
```

3. **Use correct action versions:**
```yaml
- uses: actions/upload-pages-artifact@v3  # Not v2
- uses: actions/deploy-pages@v4           # Not v3
```

**Warning signs:**
- Workflow fails at "Deploy to GitHub Pages" step
- Error mentions "permissions" or "token"
- 403 Forbidden errors in workflow logs
- First deployment works, subsequent deployments fail (branch setting issue)

### Pitfall 3: Mobile Navigation Broken by Custom CSS

**What goes wrong:** Hamburger menu opens but sidebar content invisible or unclickable. Mobile users cannot navigate site.

**Why it happens:** Custom CSS overrides Docusaurus mobile styles. Common culprits: `backdrop-filter`, color overrides without theme context, z-index conflicts, removing default styles.

**How to avoid:**
- **Use CSS variables, not hardcoded colors:**
```css
/* BAD: Hardcoded color breaks dark mode */
.custom-nav {
  background: #ffffff;
  color: #000000;
}

/* GOOD: Uses theme variables */
.custom-nav {
  background: var(--ifm-background-color);
  color: var(--ifm-font-color-base);
}
```

- **Test mobile breakpoint:**
```css
/* Always test @media (max-width: 996px) changes */
@media (max-width: 996px) {
  /* Your mobile styles */
}
```

- **Don't remove Docusaurus default styles:**
```css
/* BAD: Nukes navigation styles */
* {
  all: unset;
}

/* GOOD: Selective overrides */
.markdown {
  font-size: 1rem;
}
```

**Verification:**
- Test on real mobile device (not just browser DevTools)
- Check both light and dark mode
- Verify hamburger menu, sidebar click targets, backdrop dismiss

**Warning signs:**
- Sidebar opens but appears empty
- Sidebar content white-on-white or black-on-black
- Menu items unclickable on mobile
- Backdrop doesn't dismiss sidebar

### Pitfall 4: Search Not Working in Development

**What goes wrong:** Installed `@cmfcmf/docusaurus-search-local` but search bar doesn't appear or shows no results when running `npm start`.

**Why it happens:** Local search plugin indexes during build process, not during development. Index doesn't exist in dev mode.

**How to avoid:**
- **Understand the limitation:** This is expected behavior, not a bug.
- **Test search with production build:**
```bash
npm run build
npm run serve
# Search will work at http://localhost:3000
```

- **Document for contributors:**
```markdown
<!-- CONTRIBUTING.md -->
## Testing Search Locally

Search functionality only works with production builds:

1. Build: `npm run build`
2. Serve: `npm run serve`
3. Visit: http://localhost:3000/kubernetes-intermediate/
```

**Warning signs:**
- Search bar missing in dev mode
- Empty results when searching
- Console warnings about missing index
- Works in production but not locally

### Pitfall 5: Auto-Generated Sidebar Not Updating

**What goes wrong:** Added new file or renamed folder, but sidebar doesn't reflect changes. Old structure persists.

**Why it happens:** Docusaurus caches sidebar during build. `.docusaurus/` cache directory contains old structure.

**How to avoid:**
```bash
# Clear cache and rebuild
npm run clear
npm start

# Or combine commands
npm run clear && npm start
```

**Configure proper _category_.json:**
```json
// docs/section-N/_category_.json
{
  "label": "Section N: Title",      // Sidebar display name
  "position": N,                    // Order in sidebar
  "collapsible": true,              // Can collapse section
  "collapsed": false,               // Start expanded
  "link": {                         // Optional: section landing page
    "type": "generated-index",
    "description": "Section overview"
  }
}
```

**Verification:**
- Check `.docusaurus/docusaurus-plugin-content-docs/default/` for generated sidebar
- Restart dev server after structural changes
- Use `sidebar_position` in frontmatter for file ordering

**Warning signs:**
- New files don't appear in sidebar
- Sidebar order doesn't match `_category_.json`
- Renamed folders show old names
- Deleted files still appear

### Pitfall 6: Syntax Highlighting Missing for YAML/Bash

**What goes wrong:** Kubernetes YAML and bash commands show as plain text without highlighting. Copy button present but no color coding.

**Why it happens:** Some languages not in default Prism bundle. Must explicitly add to `additionalLanguages` array.

**How to avoid:**
```typescript
// docusaurus.config.ts
import {themes as prismThemes} from 'prism-react-renderer';

const config: Config = {
  themeConfig: {
    prism: {
      theme: prismThemes.github,
      darkTheme: prismThemes.dracula,
      additionalLanguages: ['bash', 'yaml', 'json', 'typescript'],
    },
  },
};
```

**Verify language support:**
```markdown
<!-- Test code block -->
```yaml
apiVersion: v1
kind: Pod
```

<!-- Should show syntax highlighting -->
```

**Warning signs:**
- YAML looks like plain text
- Bash commands not highlighted
- TypeScript shows as JavaScript
- Common languages greyed out

### Pitfall 7: First-Time Deployment to GitHub Pages Fails

**What goes wrong:** GitHub Actions workflow succeeds but site not accessible at GitHub Pages URL. Shows 404.

**Why it happens:** Repository settings still point to "Deploy from a branch" instead of "GitHub Actions". First deployment requires manual settings change.

**How to avoid:**
1. **Before first deployment:**
   - Go to repository Settings > Pages
   - Under "Build and deployment" > Source, select "GitHub Actions"
   - Save settings

2. **Push to main branch triggers deployment:**
   - GitHub Actions runs workflow
   - Deploys to Pages
   - Site accessible at `https://<org>.github.io/<repo>/`

3. **For existing repos with gh-pages branch:**
   - Delete `gh-pages` branch (workflow will recreate it)
   - Change source to "GitHub Actions"
   - Re-run workflow

**Warning signs:**
- Workflow shows green checkmark but site 404
- Settings page shows "Deploy from a branch"
- Old site visible but new content not updating
- URL redirects to repository instead of site

## Code Examples

Verified patterns from official sources:

### Complete docusaurus.config.ts for Phase 1

```typescript
// docusaurus.config.ts
import {themes as prismThemes} from 'prism-react-renderer';
import type {Config} from '@docusaurus/types';
import type * as Preset from '@docusaurus/preset-classic';

const config: Config = {
  title: 'Kubernetes Intermediate (SFD301)',
  tagline: 'Master Intermediate Kubernetes Concepts',
  favicon: 'img/favicon.ico',

  // GitHub Pages configuration
  url: 'https://schoolofdevops.github.io',
  baseUrl: '/kubernetes-intermediate/',
  organizationName: 'schoolofdevops',
  projectName: 'kubernetes-intermediate',
  trailingSlash: false,

  // Fail build on broken links
  onBrokenLinks: 'throw',
  onBrokenMarkdownLinks: 'warn',

  // Internationalization (future use)
  i18n: {
    defaultLocale: 'en',
    locales: ['en'],
  },

  presets: [
    [
      'classic',
      {
        docs: {
          routeBasePath: '/',  // Docs-only mode
          sidebarPath: './sidebars.ts',
          editUrl: 'https://github.com/schoolofdevops/kubernetes-intermediate/tree/main/',
          showLastUpdateTime: true,
          showLastUpdateAuthor: true,
        },
        blog: false,  // Disable blog
        theme: {
          customCss: './src/css/custom.css',
        },
      } satisfies Preset.Options,
    ],
  ],

  themeConfig: {
    // Site metadata
    metadata: [
      {name: 'keywords', content: 'kubernetes, intermediate, course, devops'},
    ],

    // Navbar
    navbar: {
      title: 'SFD301',
      logo: {
        alt: 'School of DevOps Logo',
        src: 'img/logo.svg',
      },
      items: [
        {
          type: 'docSidebar',
          sidebarId: 'courseSidebar',
          position: 'left',
          label: 'Course',
        },
        {
          href: 'https://github.com/schoolofdevops/kubernetes-intermediate',
          label: 'GitHub',
          position: 'right',
        },
      ],
    },

    // Footer
    footer: {
      style: 'dark',
      copyright: `Copyright © ${new Date().getFullYear()} School of DevOps. Apache-2.0 License.`,
    },

    // Dark mode
    colorMode: {
      defaultMode: 'light',
      disableSwitch: false,
      respectPrefersColorScheme: true,
    },

    // Syntax highlighting
    prism: {
      theme: prismThemes.github,
      darkTheme: prismThemes.dracula,
      additionalLanguages: ['bash', 'yaml', 'json', 'typescript'],
    },

    // Search (local search for Phase 1)
    // Note: Replace with Algolia when approved
    // algolia: {
    //   appId: 'YOUR_APP_ID',
    //   apiKey: 'YOUR_SEARCH_API_KEY',
    //   indexName: 'kubernetes-intermediate',
    // },

  } satisfies Preset.ThemeConfig,

  // Local search plugin
  plugins: [
    [
      require.resolve('@cmfcmf/docusaurus-search-local'),
      {
        indexDocs: true,
        indexBlog: false,
        language: 'en',
      },
    ],
  ],
};

export default config;
```

### Custom CSS for Readability and Branding

```css
/* src/css/custom.css */

/**
 * CSS variables for theming
 * Override Infima defaults for branding
 */
:root {
  /* Primary brand color */
  --ifm-color-primary: #2e8555;
  --ifm-color-primary-dark: #29784c;
  --ifm-color-primary-darker: #277148;
  --ifm-color-primary-darkest: #205d3b;
  --ifm-color-primary-light: #33925d;
  --ifm-color-primary-lighter: #359962;
  --ifm-color-primary-lightest: #3cad6e;

  /* Typography for readability */
  --ifm-font-family-base: system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
  --ifm-font-family-monospace: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace;
  --ifm-font-size-base: 16px;
  --ifm-line-height-base: 1.6;

  /* Spacing */
  --ifm-spacing-horizontal: 1.5rem;
  --ifm-global-spacing: 1.5rem;

  /* Code blocks */
  --ifm-code-font-size: 95%;
  --docusaurus-highlighted-code-line-bg: rgba(0, 0, 0, 0.1);
}

/* Dark theme overrides */
[data-theme='dark'] {
  --ifm-color-primary: #25c2a0;
  --ifm-color-primary-dark: #21af90;
  --ifm-color-primary-darker: #1fa588;
  --ifm-color-primary-darkest: #1a8870;
  --ifm-color-primary-light: #29d5b0;
  --ifm-color-primary-lighter: #32d8b4;
  --ifm-color-primary-lightest: #4fddbf;

  --docusaurus-highlighted-code-line-bg: rgba(0, 0, 0, 0.3);
}

/* Mobile responsive adjustments */
@media (max-width: 996px) {
  :root {
    --ifm-spacing-horizontal: 1rem;
    --ifm-font-size-base: 15px;
  }
}

/* Improved readability for content */
.markdown {
  /* Paragraph spacing */
  & > p {
    margin-bottom: 1.25rem;
  }

  /* Heading spacing */
  & > h2 {
    margin-top: 2.5rem;
    margin-bottom: 1rem;
  }

  & > h3 {
    margin-top: 2rem;
    margin-bottom: 0.75rem;
  }

  /* List spacing */
  & > ul, & > ol {
    margin-bottom: 1.25rem;
  }
}

/* Code block enhancements */
div[class^='codeBlockContainer'] {
  /* Ensure copy button visible on all themes */
  button {
    opacity: 0.7;
    transition: opacity 0.2s;
  }

  &:hover button {
    opacity: 1;
  }
}

/* TOC (table of contents) readability */
.table-of-contents {
  font-size: 0.875rem;
  line-height: 1.5;
}

/* Breadcrumbs styling */
.breadcrumbs__item--active {
  font-weight: 500;
}
```

### Sidebar Configuration with Auto-Generation

```typescript
// sidebars.ts
import type {SidebarsConfig} from '@docusaurus/plugin-content-docs';

/**
 * Auto-generated sidebar from filesystem structure
 * Course sections organized in docs/section-N/ folders
 * Each section has _category_.json for metadata
 */
const sidebars: SidebarsConfig = {
  courseSidebar: [
    {
      type: 'autogenerated',
      dirName: '.',  // Generate from docs/ root
    },
  ],
};

export default sidebars;
```

### GitHub Actions Workflow

```yaml
# .github/workflows/deploy.yml
name: Deploy to GitHub Pages

on:
  push:
    branches:
      - main
  pull_request:
    branches:
      - main

# Required permissions for GitHub Pages deployment
permissions:
  contents: read
  pages: write
  id-token: write

# Prevent concurrent deployments
concurrency:
  group: "pages"
  cancel-in-progress: false

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: 20
          cache: npm

      - name: Install dependencies
        run: npm ci

      - name: Build website
        run: npm run build

      - name: Upload artifact
        uses: actions/upload-pages-artifact@v3
        with:
          path: build/

  deploy:
    # Only deploy on push to main, not PRs
    if: github.event_name == 'push' && github.ref == 'refs/heads/main'
    needs: build
    runs-on: ubuntu-latest
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    steps:
      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4
```

## State of the Art

| Old Approach | Current Approach | When Changed | Impact |
|--------------|------------------|--------------|--------|
| Deploy from gh-pages branch | GitHub Actions deployment | GitHub Pages 2022 | Enables PR preview builds, no force-push conflicts, cleaner git history |
| Manual sidebar.js maintenance | Auto-generated from filesystem | Docusaurus 2.0 | Zero maintenance, filesystem as source of truth, eliminates sync issues |
| hardcoded colors in CSS | CSS variables with theme awareness | Docusaurus 2.0 | Dark mode works automatically, consistent theming, easy rebranding |
| Personal Access Token (PAT) | OIDC token authentication | GitHub Actions 2023 | No token management, automatic rotation, more secure |
| Lunr.js custom search | Plugin-based search (local or Algolia) | Docusaurus 2.0+ | Better UX, maintained by community, no custom code |

**Deprecated/outdated:**
- **Docusaurus v1:** Legacy version. No React 19 support. Use v3.9.2+.
- **Deploy from branch:** Old GitHub Pages deployment method. Use GitHub Actions.
- **Manual GITHUB_TOKEN:** Use OIDC (`id-token: write`) instead of PAT.
- **Swizzling for simple customizations:** Use CSS variables instead of ejecting components.

## Open Questions

1. **Algolia DocSearch approval timeline**
   - What we know: Application required, free for open-source, approval varies (days to weeks)
   - What's unclear: Exact timeline, approval criteria beyond "open-source documentation"
   - Recommendation: Apply immediately in Phase 1, use local search as backup until approved

2. **Performance limits for local search plugin**
   - What we know: Works well for ~100 pages, index downloads to browser
   - What's unclear: Exact breaking point for 10-section course with labs, quizzes, diagrams
   - Recommendation: Monitor bundle size during Phase 3 content creation, switch to Algolia if >5MB index

3. **Custom domain vs GitHub Pages subdomain**
   - What we know: Custom domain requires DNS configuration, GitHub Pages subdomain works immediately
   - What's unclear: School of DevOps domain strategy for course catalog
   - Recommendation: Start with `schoolofdevops.github.io/kubernetes-intermediate/`, add custom domain later if needed

## Sources

### Primary (HIGH confidence)

**Official Docusaurus Documentation:**
- [Styling and Layout | Docusaurus](https://docusaurus.io/docs/styling-layout) - Responsive design, CSS variables, Infima framework
- [Theme configuration | Docusaurus](https://docusaurus.io/docs/api/themes/configuration) - Dark mode, colorMode persistence
- [Sidebar | Docusaurus](https://docusaurus.io/docs/next/sidebar) - Auto-generated sidebars, _category_.json
- [Code blocks | Docusaurus](https://docusaurus.io/docs/markdown-features/code-blocks) - Syntax highlighting, Prism configuration, copy button
- [Search | Docusaurus](https://docusaurus.io/docs/search) - Algolia vs local search comparison
- [Deployment | Docusaurus](https://docusaurus.io/docs/deployment) - GitHub Pages configuration, baseUrl/url
- [Introduction | Docusaurus](https://docusaurus.io/docs) - Getting started, create-docusaurus

**GitHub Official Documentation:**
- [Controlling permissions for GITHUB_TOKEN - GitHub Docs](https://docs.github.com/en/actions/writing-workflows/choosing-what-your-workflow-does/controlling-permissions-for-github_token) - Workflow permissions
- [GitHub - actions/deploy-pages](https://github.com/actions/deploy-pages) - Deploy action usage, OIDC authentication

**Community Plugins:**
- [cmfcmf/docusaurus-search-local](https://github.com/cmfcmf/docusaurus-search-local) - Local search plugin documentation

### Secondary (MEDIUM confidence)

**Deployment & Workflows:**
- [How to Set Up Documentation as Code with Docusaurus and GitHub Actions](https://www.freecodecamp.org/news/set-up-docs-as-code-with-docusaurus-and-github-actions/) - Step-by-step deployment guide (2026-verified)
- [GitHub - LayZeeDK/github-pages-docusaurus](https://github.com/LayZeeDK/github-pages-docusaurus) - Reference implementation
- [Setting Up GitHub Pages with GitHub Actions - DEV Community](https://dev.to/jajera/setting-up-github-pages-with-github-actions-2o72) - Permissions troubleshooting

**Responsive Design & Mobile:**
- [Docusaurus Navbar Styling Guide: Lessons Learned | Medium](https://chanmeng666.medium.com/docusaurus-navbar-styling-guide-lessons-learned-fa2faf5b5fbf) - Mobile sidebar issues (Jan 2026)
- [Make theme desktop responsive breakpoint configurable · Issue #9603](https://github.com/facebook/docusaurus/issues/9603) - Breakpoint customization
- [Docusaurus mobile sidebar not working with backdrop-filter · Issue #6996](https://github.com/facebook/docusaurus/issues/6996) - Common mobile pitfall

**Search Integration:**
- [Integrate Docusaurus with Algolia DocSearch | Algolia](https://www.algolia.com/developers/code-exchange/integrate-docusaurus-with-algolia-docsearch) - Algolia setup guide
- [Adding local search to Docusaurous Documentation](https://medium.com/@tejasbhovad/adding-local-search-to-docusaurous-documentation-3fce8f8750a1) - Local search plugin tutorial

**Typography & Accessibility:**
- [CSS Variables | Docusaurus.community](https://docusaurus.community/knowledge/design/css/variables/) - Complete CSS variable reference
- [This is a list of all CSS variables for Docusaurus - GitHub Gist](https://gist.github.com/abhigyantrips/b828ca46b2460c6699c73e0162f6be80) - Infima variables

### Tertiary (LOW confidence, requires validation)

- Algolia DocSearch approval timeline (anecdotal reports: 1-3 weeks)
- Local search performance limits (community reports: works up to ~100 pages)
- Custom domain setup details (project-specific)

## Metadata

**Confidence breakdown:**
- Standard stack: HIGH - Official documentation, npm package verification, version compatibility confirmed
- Architecture patterns: HIGH - Official docs, verified examples, production-tested patterns
- Common pitfalls: HIGH - Official GitHub issues, community reports, reproducible scenarios
- Code examples: HIGH - Sourced from official docs, verified TypeScript compilation

**Research date:** 2026-02-08
**Valid until:** 2026-05-08 (3 months - stable platform, slow-moving breaking changes)

**Validation notes:**
- Docusaurus 3.9.2 released 3 months ago (Nov 2025), stable
- GitHub Actions workflow patterns current as of Feb 2026
- Mobile breakpoint (996px) unchanged since Docusaurus 2.0
- Search plugin ecosystem stable (both Algolia and local search actively maintained)

**Next steps for planner:**
- Use this research to create PLAN.md tasks
- All requirements (SITE-01 through SITE-06, NAV-01 through NAV-06) addressable with this stack
- No custom development needed—configuration and content creation only
- Estimated Phase 1 duration: 3-5 days (setup, configure, deploy, verify)
